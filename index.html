// Nuova funzione per prendere ricette dalle API Gemini
async function fetchRecipes() {
  state.showRecipes = true;
  state.recipes = [];
  render();

  const recipesContainer = document.getElementById('app');
  // loading semplice
  recipesContainer.insertAdjacentHTML('beforeend', `
    <div id="loadingRecipes" class="text-center text-gray-500 mt-2">‚è≥ Caricamento ricette...</div>
  `);

  try {
    const response = await fetch('https://api.gemini.com/v1/recipes', {  // esempio URL, metti quello vero
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer TUA_CHIAVE_API_GEMINI'
      },
      body: JSON.stringify({
        prompt: 'Dammi 5 ricette italiane facili e veloci',
        max_results: 5
      })
    });

    const data = await response.json();
    // supponendo data.recipes sia l'array
    state.recipes = data.recipes.map((r, i) => ({ id: `api-${i}`, title: r.title || r.name || r }));
    render();

  } catch(err) {
    alert('Errore nel recuperare le ricette. Riprova!');
    console.error(err);
  } finally {
    const loadingEl = document.getElementById('loadingRecipes');
    if(loadingEl) loadingEl.remove();
  }
}

// aggiorno il toggleRecipes per chiamare fetchRecipes
window.toggleRecipes = () => {
  if(!state.showRecipes) {
    fetchRecipes(); // quando apro le ricette, chiamo le API
  } else {
    state.showRecipes = false;
    render();
  }
};
